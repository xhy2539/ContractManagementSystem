spring.application.name=ContractManagementSystem


server.address=0.0.0.0
spring.datasource.url=${DB_URL:jdbc:mysql://113.44.162.97:3306/contract?serverTimezone=UTC&useUnicode=true&characterEncoding=utf-8&createDatabaseIfNotExist=true&zeroDateTimeBehavior=convertToNull&useSSL=false}
spring.datasource.username=${DB_USERNAME:test}
spring.datasource.password=${DB_PASSWORD:Zjj123456}
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# JPA/Hibernate
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false
spring.jpa.open-in-view=false
# Hibernate可以自动检测MySQL方言，无需手动指定
# spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQLDialect

# 优化Hibernate性能
spring.jpa.properties.hibernate.jdbc.batch_size=25
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.jdbc.batch_versioned_data=true
spring.jpa.properties.hibernate.jdbc.fetch_size=50

# 禁用默认的batch fetching，强制使用JOIN FETCH
spring.jpa.properties.hibernate.default_batch_fetch_size=0

# 查询统计和调试（生产环境应关闭）
spring.jpa.properties.hibernate.generate_statistics=false
spring.jpa.properties.hibernate.format_sql=false

# 二级缓存配置
spring.jpa.properties.hibernate.cache.use_second_level_cache=true
spring.jpa.properties.hibernate.cache.use_query_cache=true
spring.jpa.properties.hibernate.cache.region.factory_class=org.hibernate.cache.jcache.JCacheRegionFactory

spring.thymeleaf.encoding=UTF-8
spring.thymeleaf.servlet.content-type=text/html; charset=UTF-8
server.servlet.encoding.charset=UTF-8
server.servlet.encoding.enabled=true
server.servlet.encoding.force=true

logging.level.org.springframework.security=INFO
logging.level.org.springframework.security.web.session=DEBUG
logging.level.org.springframework.security.core.session=DEBUG
logging.level.com.example.contractmanagementsystem.service.ContractServiceImpl=DEBUG
file.upload-dir=${UPLOAD_DIR:./uploads/}

spring.servlet.multipart.max-request-size=200MB

spring.mail.host=smtp.qq.com

spring.mail.port=465

spring.mail.username=${MAIL_USERNAME:hyxiong2539@qq.com}

spring.mail.password=${MAIL_PASSWORD:yemmiewxuszajbid}


spring.mail.properties.mail.smtp.ssl.enable=true
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.socketFactory.class=javax.net.ssl.SSLSocketFactory
spring.mail.properties.mail.smtp.socketFactory.fallback=false
spring.mail.properties.mail.smtp.socketFactory.port=465

# 智能分析模块配置
analysis.scheduler.enabled=true
analysis.risk.threshold.critical=75
analysis.risk.threshold.high=50
analysis.risk.threshold.medium=25
analysis.reminder.cleanup.days=30
analysis.reanalysis.days=7

# 安全配置优化
server.servlet.session.timeout=30m
server.servlet.session.cookie.secure=true
server.servlet.session.cookie.http-only=true

# 添加连接池配置
spring.datasource.hikari.maximum-pool-size=20
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=20000
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.max-lifetime=1800000

# 缓存配置优化
spring.cache.type=jcache
spring.cache.jcache.provider=com.github.benmanes.caffeine.jcache.spi.CaffeineCachingProvider
spring.cache.caffeine.spec=maximumSize=1000,expireAfterAccess=300s

# 邮件配置 - 使用环境变量
# 文件上传配置优化
spring.servlet.multipart.max-file-size=20MB
# 添加actuator监控
management.endpoints.web.exposure.include=health,info,metrics
management.endpoint.health.show-details=when-authorized

# 日志配置优化
logging.level.root=INFO
logging.level.com.example.contractmanagementsystem=DEBUG
logging.pattern.file=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n
logging.file.name=logs/contract-management.log
logging.file.max-size=10MB
logging.file.max-history=30

# 日志编码配置
logging.charset.console=UTF-8
logging.charset.file=UTF-8
