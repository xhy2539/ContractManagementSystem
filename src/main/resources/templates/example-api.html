<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{fragments/layout}">
<head>
    <title>前端组件示例</title>
    <style layout:fragment="inline-css">
        .example-section {
            background: white;
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .example-title {
            color: #667eea;
            font-weight: 600;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #f3f4f6;
        }
        
        .code-block {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 0.9rem;
            overflow-x: auto;
        }
        
        .demo-result {
            background: #f0f9ff;
            border: 1px solid #bae6fd;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
        }
    </style>
</head>
<body>
    <div layout:fragment="content">
        <div class="mb-4">
            <h2>
                <i class="bi bi-code-square"></i> 前端组件使用示例
            </h2>
            <p class="text-muted">展示如何使用合同管理系统的前端组件和工具函数</p>
        </div>

        <!-- AJAX请求示例 -->
        <div class="example-section">
            <h3 class="example-title">
                <i class="bi bi-cloud-arrow-up"></i> AJAX请求
            </h3>
            <p>使用ContractApp.ajax方法进行API调用：</p>
            
            <div class="code-block">
// GET请求示例
ContractApp.ajax({
    url: '/api/contracts',
    method: 'GET'
}).then(data => {
    console.log('获取合同列表成功:', data);
}).catch(error => {
    ContractApp.showMessage('请求失败: ' + error.message, 'danger');
});

// POST请求示例
ContractApp.ajax({
    url: '/api/contracts',
    method: 'POST',
    body: JSON.stringify({
        contractName: '新合同',
        customerId: 1,
        startDate: '2024-01-01',
        endDate: '2024-12-31'
    })
}).then(data => {
    ContractApp.showMessage('合同创建成功', 'success');
}).catch(error => {
    ContractApp.showMessage('创建失败: ' + error.message, 'danger');
});
            </div>
            
            <button class="btn btn-primary" onclick="testAjaxRequest()">
                <i class="bi bi-play"></i> 测试AJAX请求
            </button>
            <div id="ajaxResult" class="demo-result d-none"></div>
        </div>

        <!-- 消息提示示例 -->
        <div class="example-section">
            <h3 class="example-title">
                <i class="bi bi-bell"></i> 消息提示
            </h3>
            <p>显示不同类型的消息提示：</p>
            
            <div class="code-block">
// 成功消息
ContractApp.showMessage('操作成功完成！', 'success');

// 警告消息
ContractApp.showMessage('请注意检查输入信息', 'warning');

// 错误消息
ContractApp.showMessage('操作失败，请重试', 'danger');

// 信息消息
ContractApp.showMessage('数据加载完成', 'info');
            </div>
            
            <div class="d-flex gap-2 flex-wrap">
                <button class="btn btn-success" onclick="ContractApp.showMessage('这是成功消息！', 'success')">
                    成功消息
                </button>
                <button class="btn btn-warning" onclick="ContractApp.showMessage('这是警告消息！', 'warning')">
                    警告消息
                </button>
                <button class="btn btn-danger" onclick="ContractApp.showMessage('这是错误消息！', 'danger')">
                    错误消息
                </button>
                <button class="btn btn-info" onclick="ContractApp.showMessage('这是信息消息！', 'info')">
                    信息消息
                </button>
            </div>
        </div>

        <!-- 确认对话框示例 -->
        <div class="example-section">
            <h3 class="example-title">
                <i class="bi bi-question-circle"></i> 确认对话框
            </h3>
            <p>显示确认对话框并处理用户选择：</p>
            
            <div class="code-block">
ContractApp.confirm('确定要删除这个合同吗？', function() {
    // 用户点击确定后执行的操作
    ContractApp.showMessage('合同已删除', 'success');
});
            </div>
            
            <button class="btn btn-danger" onclick="showConfirmExample()">
                <i class="bi bi-trash"></i> 显示确认对话框
            </button>
        </div>

        <!-- 加载状态示例 -->
        <div class="example-section">
            <h3 class="example-title">
                <i class="bi bi-arrow-clockwise"></i> 加载状态
            </h3>
            <p>显示和隐藏加载状态：</p>
            
            <div class="code-block">
// 显示加载状态
ContractApp.showLoading();

// 模拟异步操作
setTimeout(() => {
    // 隐藏加载状态
    ContractApp.hideLoading();
    ContractApp.showMessage('操作完成', 'success');
}, 2000);
            </div>
            
            <button class="btn btn-primary" onclick="showLoadingExample()">
                <i class="bi bi-play"></i> 显示加载状态
            </button>
        </div>

        <!-- 工具函数示例 -->
        <div class="example-section">
            <h3 class="example-title">
                <i class="bi bi-tools"></i> 工具函数
            </h3>
            <p>使用内置的工具函数：</p>
            
            <div class="code-block">
// 日期格式化
const formattedDate = ContractUtils.date.format(new Date(), 'YYYY-MM-DD HH:mm:ss');

// 字符串截断
const shortText = ContractUtils.string.truncate('这是一个很长的文本...', 10);

// 防抖函数
const debouncedFunction = ContractUtils.event.debounce(() => {
    console.log('执行防抖函数');
}, 500);

// 本地存储
ContractUtils.storage.set('userPrefs', { theme: 'light' }, 3600000); // 1小时过期
const prefs = ContractUtils.storage.get('userPrefs');
            </div>
            
            <button class="btn btn-info" onclick="testUtilityFunctions()">
                <i class="bi bi-play"></i> 测试工具函数
            </button>
            <div id="utilityResult" class="demo-result d-none"></div>
        </div>

        <!-- 表单验证示例 -->
        <div class="example-section">
            <h3 class="example-title">
                <i class="bi bi-check-circle"></i> 表单验证
            </h3>
            <p>使用内置的表单验证功能：</p>
            
            <form id="exampleForm">
                <div class="row g-3">
                    <div class="col-md-6">
                        <label class="form-label">姓名 *</label>
                        <input type="text" class="form-control" name="name" placeholder="请输入姓名">
                    </div>
                    <div class="col-md-6">
                        <label class="form-label">邮箱 *</label>
                        <input type="email" class="form-control" name="email" placeholder="请输入邮箱">
                    </div>
                    <div class="col-12">
                        <label class="form-label">电话</label>
                        <input type="tel" class="form-control" name="phone" placeholder="请输入电话号码">
                    </div>
                </div>
                <div class="mt-3">
                    <button type="button" class="btn btn-primary" onclick="validateExampleForm()">
                        <i class="bi bi-check"></i> 验证表单
                    </button>
                    <button type="button" class="btn btn-secondary" onclick="clearExampleForm()">
                        <i class="bi bi-arrow-clockwise"></i> 清空表单
                    </button>
                </div>
            </form>
            
            <div class="code-block">
const validationRules = {
    name: {
        required: true,
        requiredMessage: '请输入姓名',
        minLength: 2,
        minLengthMessage: '姓名至少需要2个字符'
    },
    email: {
        required: true,
        requiredMessage: '请输入邮箱',
        pattern: /^[^\s@]+@[^\s@]+\.[^\s@]+$/,
        patternMessage: '请输入有效的邮箱地址'
    },
    phone: {
        pattern: /^1[3-9]\d{9}$/,
        patternMessage: '请输入有效的手机号码'
    }
};

const result = ContractUtils.form.validate(form, validationRules);
if (result.isValid) {
    console.log('表单验证通过');
} else {
    console.log('验证失败:', result.errors);
}
            </div>
        </div>

        <!-- 动态内容示例 -->
        <div class="example-section">
            <h3 class="example-title">
                <i class="bi bi-magic"></i> 动态内容生成
            </h3>
            <p>动态创建和操作DOM元素：</p>
            
            <div class="code-block">
// 创建卡片元素
const card = ContractUtils.dom.create('div', {
    className: 'card',
    innerHTML: `
        &lt;div class="card-body"&gt;
            &lt;h5 class="card-title"&gt;动态卡片&lt;/h5&gt;
            &lt;p class="card-text"&gt;这是通过JavaScript动态创建的卡片&lt;/p&gt;
        &lt;/div&gt;
    `
});

document.getElementById('dynamicContent').appendChild(card);
            </div>
            
            <button class="btn btn-success" onclick="createDynamicContent()">
                <i class="bi bi-plus"></i> 创建动态内容
            </button>
            <button class="btn btn-danger" onclick="clearDynamicContent()">
                <i class="bi bi-trash"></i> 清空内容
            </button>
            <div id="dynamicContent" class="mt-3"></div>
        </div>
    </div>

    <!-- JavaScript -->
    <script layout:fragment="scripts">
        // AJAX请求测试
        function testAjaxRequest() {
            const resultDiv = document.getElementById('ajaxResult');
            resultDiv.classList.remove('d-none');
            resultDiv.innerHTML = '<i class="bi bi-arrow-clockwise"></i> 正在请求数据...';
            
            // 模拟API请求
            setTimeout(() => {
                resultDiv.innerHTML = `
                    <strong>模拟API响应：</strong><br>
                    <code>{ "message": "请求成功", "timestamp": "${new Date().toISOString()}" }</code>
                `;
                ContractApp.showMessage('API请求测试完成', 'success');
            }, 1000);
        }

        // 确认对话框示例
        function showConfirmExample() {
            ContractApp.confirm('这是一个确认对话框示例，确定要继续吗？', function() {
                ContractApp.showMessage('您点击了确定按钮', 'info');
            });
        }

        // 加载状态示例
        function showLoadingExample() {
            ContractApp.showLoading();
            setTimeout(() => {
                ContractApp.hideLoading();
                ContractApp.showMessage('加载完成', 'success');
            }, 2000);
        }

        // 工具函数测试
        function testUtilityFunctions() {
            const resultDiv = document.getElementById('utilityResult');
            resultDiv.classList.remove('d-none');
            
            const results = [
                `日期格式化: ${ContractUtils.date.format(new Date(), 'YYYY-MM-DD HH:mm:ss')}`,
                `字符串截断: ${ContractUtils.string.truncate('这是一个很长的文本内容，需要被截断显示', 15)}`,
                `随机字符串: ${ContractUtils.string.random(8)}`,
                `首字母大写: ${ContractUtils.string.capitalize('hello world')}`,
                `相对时间: ${ContractUtils.date.relative(new Date(Date.now() - 3600000))}`
            ];
            
            resultDiv.innerHTML = `
                <strong>工具函数测试结果：</strong><br>
                ${results.map(result => `<div>${result}</div>`).join('')}
            `;
        }

        // 表单验证
        function validateExampleForm() {
            const form = document.getElementById('exampleForm');
            const validationRules = {
                name: {
                    required: true,
                    requiredMessage: '请输入姓名',
                    minLength: 2,
                    minLengthMessage: '姓名至少需要2个字符'
                },
                email: {
                    required: true,
                    requiredMessage: '请输入邮箱',
                    pattern: /^[^\s@]+@[^\s@]+\.[^\s@]+$/,
                    patternMessage: '请输入有效的邮箱地址'
                },
                phone: {
                    pattern: /^1[3-9]\d{9}$/,
                    patternMessage: '请输入有效的手机号码'
                }
            };

            const result = ContractUtils.form.validate(form, validationRules);
            if (result.isValid) {
                ContractApp.showMessage('表单验证通过！', 'success');
                console.log('表单数据:', ContractUtils.form.serialize(form));
            } else {
                ContractApp.showMessage('表单验证失败，请检查输入', 'warning');
                console.log('验证错误:', result.errors);
            }
        }

        // 清空表单
        function clearExampleForm() {
            const form = document.getElementById('exampleForm');
            ContractUtils.form.clear(form);
            ContractApp.showMessage('表单已清空', 'info');
        }

        // 创建动态内容
        function createDynamicContent() {
            const container = document.getElementById('dynamicContent');
            
            const card = ContractUtils.dom.create('div', {
                className: 'card mb-3 fade-in',
                innerHTML: `
                    <div class="card-body">
                        <h5 class="card-title">
                            <i class="bi bi-star"></i> 动态生成的卡片
                        </h5>
                        <p class="card-text">
                            这是通过JavaScript动态创建的卡片，创建时间：${new Date().toLocaleString()}
                        </p>
                        <button class="btn btn-sm btn-outline-primary" onclick="this.parentElement.parentElement.remove()">
                            <i class="bi bi-x"></i> 删除此卡片
                        </button>
                    </div>
                `
            });
            
            container.appendChild(card);
            ContractApp.showMessage('动态内容已创建', 'success');
        }

        // 清空动态内容
        function clearDynamicContent() {
            const container = document.getElementById('dynamicContent');
            container.innerHTML = '';
            ContractApp.showMessage('动态内容已清空', 'info');
        }

        // 页面加载完成后执行
        document.addEventListener('DOMContentLoaded', function() {
            console.log('前端组件示例页面已加载');
            console.log('可用的工具函数:', ContractUtils);
            console.log('可用的应用函数:', ContractApp);
        });
    </script>
</body>
</html> 